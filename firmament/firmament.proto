syntax = "proto3";

package firmament;

message Block {
    string sha256sum = 1;
    uint64 mtime = 2;
}

message BlockDatabase {
    repeated Block blocks = 1;
}

message File {
    // Path within the filesystem, starting with /
    string path = 1;

    // Modification time/version, unix epoch secs
    uint64 mtime = 2;

    // Block hashes
    repeated string blocks = 3;

    // Size in bytes
    uint64 size = 4;

    // Special file types
    enum FileType {
        FILE_TYPE_NORMAL = 0;
        FILE_TYPE_EXECUTABLE = 1;
        FILE_TYPE_DELETED = 2;
    }
    FileType type = 5;

    // Arbitrary tags for this file
    repeated string tags = 6;
}

message FileDatabase {
    repeated File files = 1;
}
